


NMRG                                                    G. van den Broek
Internet-Draft                                      University of Twente
Intended status: Informational                                 M. Harvan
Expires: May 30, 2008                                         ETH Zurich
                                                                 A. Pras
                                                    University of Twente
                                                        J. Schoenwaelder
                                                Jacobs University Bremen
                                                       November 27, 2007


                    SNMP Trace Analysis Definitions
             draft-irtf-nmrg-snmp-trace-definitions-00.txt

Status of this Memo

   By submitting this Internet-Draft, each author represents that any
   applicable patent or other IPR claims of which he or she is aware
   have been or will be disclosed, and any of which he or she becomes
   aware will be disclosed, in accordance with Section 6 of BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF), its areas, and its working groups.  Note that
   other groups may also distribute working documents as Internet-
   Drafts.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   The list of current Internet-Drafts can be accessed at
   http://www.ietf.org/ietf/1id-abstracts.txt.

   The list of Internet-Draft Shadow Directories can be accessed at
   http://www.ietf.org/shadow.html.

   This Internet-Draft will expire on May 30, 2008.

Copyright Notice

   Copyright (C) The IETF Trust (2007).









van den Broek, et al.     Expires May 30, 2008                  [Page 1]

Internet-Draft       SNMP Trace Analysis Definitions       November 2007


Abstract

   The Network Management Research Group (NMRG) started an activity to
   collect traces of the Simple Network Management Protocol (SNMP) from
   operational networks.  To analyze these traces, it is necessary to
   split potentially large traces into more manageable pieces that also
   make it easier to deal with large data sets and simplify the analysis
   of the data.

   This document provides some common definitions that have been found
   useful for implementing tools to support trace analysis.  This
   document mainly serves as a reference for the definitions underlying
   these tools and it is not meant to explain all the motivation and
   reasoning behind the definitions.  Some of this background
   information can be found in other research papers.


Table of Contents

   1.  Introduction . . . . . . . . . . . . . . . . . . . . . . . . .  3
   2.  Overview . . . . . . . . . . . . . . . . . . . . . . . . . . .  4
   3.  Messages . . . . . . . . . . . . . . . . . . . . . . . . . . .  5
   4.  Traces . . . . . . . . . . . . . . . . . . . . . . . . . . . .  8
   5.  Flows  . . . . . . . . . . . . . . . . . . . . . . . . . . . .  9
   6.  Slices . . . . . . . . . . . . . . . . . . . . . . . . . . . . 10
   7.  Slice Sets - (more thoughts needed)  . . . . . . . . . . . . . 12
   8.  Walks - (more thoughts needed) . . . . . . . . . . . . . . . . 13
   9.  Security Considerations  . . . . . . . . . . . . . . . . . . . 14
   10. Acknowledgements . . . . . . . . . . . . . . . . . . . . . . . 15
   11. References . . . . . . . . . . . . . . . . . . . . . . . . . . 16
     11.1.  Normative References  . . . . . . . . . . . . . . . . . . 16
     11.2.  Informative References  . . . . . . . . . . . . . . . . . 16
   Authors' Addresses . . . . . . . . . . . . . . . . . . . . . . . . 17
   Intellectual Property and Copyright Statements . . . . . . . . . . 18

















van den Broek, et al.     Expires May 30, 2008                  [Page 2]

Internet-Draft       SNMP Trace Analysis Definitions       November 2007


1.  Introduction

   The Network Management Research Group (NMRG) started an activity to
   collect traces of the Simple Network Management Protocol (SNMP)
   [RFC3410] [RFC3411] from operational networks.  To analyze these
   traces, it is necessary to split potentially large traces into more
   manageable pieces that also make it easier to deal with large data
   sets and simplify the analysis of the data.

   This document provides some common definitions that have been found
   useful for implementing tools to support trace analysis.  This
   document mainly serves as a reference for the definitions underlying
   these tools and it is not meant to explain all the motivation and
   reasoning behind the definitions.  Some of this background
   information can be found in other research papers.

   More information and the motivation for SNMP trace collection and
   analysis can be found in RFC XXXX [ID-IRTF-NMRG-SNMP-MEASURE-01].

































van den Broek, et al.     Expires May 30, 2008                  [Page 3]

Internet-Draft       SNMP Trace Analysis Definitions       November 2007


2.  Overview


           +----------------+ 1     1..* +-----------+
           | Slice Set Type |------------| Slice Set |
           +----------------+            +-----------+
                                                | 1
                                                | ^belongs_to
                                                |
   +-------+ 1     0..* +------+ 1     0..* +-------+
   | Trace |------------| Flow |------------| Slice |
   +-------+  contains> +------+  contains> +-------+
                                                ^
                                                | ^is_a
                                                |
                                            +-------+
                                            | Walk  |
                                            +-------+
                                              ^   ^
                      +-----------------------+   |
                      |                           |
               +-------------+     +-------------------------+
               | Strict Walk |     | Prefix Constrained Walk |
               +-------------+     +-------------------------+

   [TODO: describe the general relation between traces, flows, slices,
   etc. to give the reader a short introduction to the terminology]
























van den Broek, et al.     Expires May 30, 2008                  [Page 4]

Internet-Draft       SNMP Trace Analysis Definitions       November 2007


3.  Messages

   Notation: Let M be a message.  We denote the properties of M as
   follows:

      M.type    = operation type of message M (get, getnext, ...)
      M.class   = class of message M (according RFC 3411)
      M.tsrc    = transport layer source endpoint of message M
      M.tdst    = transport layer destination endpoint of message M
      M.nsrc    = network layer source endpoint of message M
      M.ndst    = network layer destination endpoint of message M
      M.reqid   = request identifier of message M
      M.time    = capture timestamp of message M
      M.oids    = OIDs listed in varbind list of message M
      M.values  = values listed in varbind list of message M

   Note that the properties of a message can be easily extracted from
   the exchange formats defined in RFC XXXX
   [ID-IRTF-NMRG-SNMP-MEASURE-01].

   Definition (read request message): A read request message is a
   message M containing a PDU of type GetRequest, GetNextRequest, or
   GetBulkRequest.

   Definition (write request message): A write request message is a
   message M containing a PDU of type SetRequest.

   Definition (notify request message): A notify request message is a
   message M containing a PDU of type InformRequest.

   Definition (request message): A request message is a message M which
   is either a read request message, a write request message, or a
   notify request message.

   Definition (response message): A response message is a message M
   containing a PDU of type Response or of type Report.

   Note that Report messages are treated like Response messages since
   the SNMPv3 specifications currently use Report messages only as an
   error reporting mechanism, always triggered by the processing of some
   request messages.  In case future SNMP versions or extensions use
   Report messages without having a request triggering the generation of
   Report messages, we may have to revisit the definition above.

   Definition (non-response message): A non-response message is a
   message M which is not a response message.

   Definition (notification message): A notification message is a



van den Broek, et al.     Expires May 30, 2008                  [Page 5]

Internet-Draft       SNMP Trace Analysis Definitions       November 2007


   message M containing a PDU of type Trap or InformRequest.

   Definition (command message): A command message is a message M which
   is either a read request message or a write request message.

   Definition (command group messages): The set of command group
   messages consists of all messages M satisfying the following
   conditions:

   (C1)   M is a command message or

   (C2)   M is a response message and there exists a command message C
          such that the following holds:

             M.reqid = C.reqid
             M.tdst  = C.tsrc
             M.tsrc  = C.tdst
             (M.time - C.time) < t

   The parameter t defines a maximum timeout for response messages.

   Note that this definition requires that the response messages
   originates from the transport endpoint over which the request message
   has been received.  This is not strictly required by SNMP transport
   mappings and in particular the UDP transport mapping allows to send
   responses from different transport endpoints.  While sending response
   messages from a different transport endpoint is legal, it is also
   considered bad practice causing interoperability problems since
   several management systems do not accept such messages.

   It was decided to require matching transport endpoints since doing so
   significantly simplifies the procedures below and avoids accidentally
   confusing requests and responses.  Note that implementations
   responding from different transport endpoints will lead to (a) a
   larger number of requests without responses (and likely no retries)
   and (b) a similarly large number of response messages without a
   matching request.  If such behavior can be detected, people should
   investigate the traces and if needed correct the transport endpoints.

   Definition (notification group messages): The set of group
   notification messages consists of all messages M satisfying the
   following conditions:

   (N1)   M is a notification message or







van den Broek, et al.     Expires May 30, 2008                  [Page 6]

Internet-Draft       SNMP Trace Analysis Definitions       November 2007


   (N2)   M is a response message and there exists a notify request
          message N such that the following holds:

             M.reqid = N.reqid
             M.tdst  = N.tsrc
             M.tsrc  = N.tdst
             (M.time - N.time) < t

   The parameter t defines a maximum timeout for response messages.

   Note that we again require that the transport endpoints match for
   notification group messages.







































van den Broek, et al.     Expires May 30, 2008                  [Page 7]

Internet-Draft       SNMP Trace Analysis Definitions       November 2007


4.  Traces

   Definition (trace): An SNMP trace (or short trace) T is an ordered
   set of zero or more SNMP messages M for which the following holds:

   (T3)   Each messages M in T is either a non-response message or a
          response message.

   (T4)   All messages M in T are chronologically ordered according to
          the capture time stamp M.time.

   (T5)   [TODO: For each message in M are all stated properties known.
          I believe this requirement is wrong; my traces contain various
          amounts of unknown fields, also due to anonymization
          requirements.  Saying these traces are not traces feels wrong
          nor does it help in any of the other definitions.  And
          finally, it is not clear what "all stated properties" actually
          refers to.]

































van den Broek, et al.     Expires May 30, 2008                  [Page 8]

Internet-Draft       SNMP Trace Analysis Definitions       November 2007


5.  Flows

   Definition (flow): A flow F is the set of messages of an SNMP trace T
   with the following properties:

   (F1)   All response messages originate from a single network
          endpoint.

   (F2)   All non-response messages originate from a single network
          endpoint.

   (F3)   All messages are either command group messages or notification
          group messages.

   Subsequently, we call flows containing command group messages command
   flows.  Similarly, we call flows containing notification group
   messages notification flows.

   Note that it is possible that response messages of a trace cannot be
   classified to belong to any flow.  This can happen if request
   messages triggering the response messages were not recorded (for
   example due to asymmetric routing) or because response messages were
   originating from transport endpoints different from the endpoint used
   to receive the associated request message.

   Definition (flow initiator): A flow initiator is the one of the
   network endpoints involved in a flow, which is responsible for
   sending the first non-response message.

   Notation: Let F be a flow as defined above.  We denote the properties
   of F as follows:

      F.type  = type of the flow F (command/notification/internal flow)
      F.nsrc  = network layer source endpoint of F
      F.ndst  = network layer destination endpoint of F
      F.start = time stamp of the chronologically first message in F
      F.end   = time stamp of the chronologically last message in F

   This definition of a flow is mostly consistent with the definition of
   a flow used in [SPHSM07].  The difference is that the tool used to
   generate the data reported in [SPHSM07] did only require that the
   network layer source endpoint has been used by response messages
   matches the destination network layer endpoint of the associated
   request messages.







van den Broek, et al.     Expires May 30, 2008                  [Page 9]

Internet-Draft       SNMP Trace Analysis Definitions       November 2007


6.  Slices

   Definition (slice): A slice S is a subset of messages in a flow F for
   which the following properties hold:

   (S1)   All messages are exchanged between two transport endpoints (a
          single transport endpoint pair).

   (S2)   All request messages must be of the same type.

   (S3)   All Get, Set, Trap, Inform messages must contain the same set
          of OIDs.

   (S4)   Each GetNext or GetBulk message must either contain the same
          set of OIDs or they must be linked to the chronologically last
          response of the previous request, that is the request must
          contain at least one OID that has been contained in the
          (repeater) varbind list of the chronologically last response
          message of a previous request message.

   (S5)   All Response messages must follow a previous request message
          that is part of the same slice.

   (S6)   For a request message Q following the last response message R
          to the previous request, the condition (Q.time - R.time) < e
          is true.

   Definition (slice initiator): A slice initiator is one of the two
   transport endpoints involved in a slice, which is responsible for
   sending the chronologically first non-response class message.

   Definition (slice prefix): [TODO]

   Notation: A slice S has several properties.  We introduce the
   following notation:

      S.type     = type of non-response messages in S
      S.tsrc     = transport layer endpoint of initiator of S
      S.tdst     = transport layer endpoint of non-initiator of S
      S.start    = time stamp of the chronologically first message in S
      S.end      = time stamp of the chronologically last message in S
      S.prefix   = prefix of S









van den Broek, et al.     Expires May 30, 2008                 [Page 10]

Internet-Draft       SNMP Trace Analysis Definitions       November 2007


   Definition (concurrency): Two slides A and B of a given flow F are
   concurrent at time t if A.start <= t <= A.end and B.start <= t <=
   B.end.  The concurrency level F.clevel(t) of a flow F at time t is
   given by the number of concurrent slices of F at time t.  The
   concurrency level of a manager identified by the network address addr
   at time t is given by the sum of the flow currency levels F.clevel(t)
   for all flows originating from addr, that is F.nsrc = addr.

   Definition (delta time serial): Two slides A and B of a given flow F
   are called delta time serial if (B.start - A.end) < delta.









































van den Broek, et al.     Expires May 30, 2008                 [Page 11]

Internet-Draft       SNMP Trace Analysis Definitions       November 2007


7.  Slice Sets - (more thoughts needed)

   Definition (slice type): A slice type is a type mark identifying
   slices that share the following properties:

   (ST1)   All messages have been exchanged between the same transport
           endpoints.

   (ST2)   All read request messages, write request messages, and
           notification messages originate from the same transport
           endpoint.

   (ST3)   All non-response messages are of the same type

   [TODO: Should this be an equivalence relation so that slice sets turn
   into equivalent classes?]

   Definition (slice set): A slice set is a set of slices that have the
   following properties:

   (SS1)   All READ, WRITE, NOTIFY messages originate from the same
           transport endpoint. (really transport???)

   (SS2)   ???

   (SS3)   All messages occurred within a specific time frame of each
           other. (what does this mean??? do we need delta serial for
           messages???)























van den Broek, et al.     Expires May 30, 2008                 [Page 12]

Internet-Draft       SNMP Trace Analysis Definitions       November 2007


8.  Walks - (more thoughts needed)

   Definition (walk): A walk W is a slice S with the following
   properties:

   (W1)   The type of the slice S is either get-next-request or get-
          bulk-request.

   (W2)   At least one object identifier in the sequence of requests at
          the same varbind index must be increasing lexicographically
          while all object identifiers at the same varbind index have to
          be non-decreasing.

   Definition (strict walk): A walk W is a strict walk if all object
   identifiers in the sequence of requests at the same varbind index are
   strictly increasing lexicographically.  Furthermore, the object
   identifiers at the same index of a response and a subsequent request
   must be identical.

   Definition (prefix constrained walk): A walk W is prefix constrained
   if all object identifiers at the same index have the same object
   identifier prefix.  This prefix is established by the first request
   within the walk.




























van den Broek, et al.     Expires May 30, 2008                 [Page 13]

Internet-Draft       SNMP Trace Analysis Definitions       November 2007


9.  Security Considerations

   This document provides definitions for the analysis of SNMP traces
   and does not impact the security of the Internet.















































van den Broek, et al.     Expires May 30, 2008                 [Page 14]

Internet-Draft       SNMP Trace Analysis Definitions       November 2007


10.  Acknowledgements

   This document was influenced by discussions within the Network
   Management Research Group (NMRG).

   Part of this work was funded by the European Commission under grant
   FP6-2004-IST-4-EMANICS-026854-NOE.












































van den Broek, et al.     Expires May 30, 2008                 [Page 15]

Internet-Draft       SNMP Trace Analysis Definitions       November 2007


11.  References

11.1.  Normative References

   [RFC3411]  Harrington, D., Presuhn, R., and B. Wijnen, "An
              Architecture for Describing Simple Network Management
              Protocol (SNMP) Management Frameworks", RFC 3411,
              December 2002.

11.2.  Informative References

   [RFC3410]  Case, J., Mundy, R., Partain, D., and B. Stewart,
              "Introduction and Applicability Statements for Internet
              Standard Management Framework", RFC 3410, December 2002.

   [ID-IRTF-NMRG-SNMP-MEASURE-01]
              Schoenwaelder, J., "An Architecture for Describing Simple
              Network Management Protocol (SNMP) Management Frameworks",
              ID draft-irtf-nmrg-snmp-measure-01.txt, January 2007.

   [SPHSM07]  Schoenwaelder, J., Pras, A., Harvan, M., Schippers, J.,
              and R. van de Meent, "SNMP Traffic Analysis: Approaches,
              Tools, and First Results", IFIP/IEEE Integrated
              Management IM 2007, May 2007.



























van den Broek, et al.     Expires May 30, 2008                 [Page 16]

Internet-Draft       SNMP Trace Analysis Definitions       November 2007


Authors' Addresses

   Gijs van den Broek
   University of Twente
   P.O. BOX 217
   7500 AE Enschede
   Netherlands

   Phone:
   Email: j.g.vandenbroek@student.utwente.nl


   Matus Harvan
   ETH Zurich
   ETH Zentrum
   8092 Zurich
   Switzerland

   Phone: +41 44 632 68 76
   Email: mharvan@inf.ethz.ch


   Aiko Pras
   University of Twente
   P.O. BOX 217
   7500 AE Enschede
   Netherlands

   Phone: +31 53 4893778
   Email: a.pras@cs.utwente.nl


   Juergen Schoenwaelder
   Jacobs University Bremen
   Campus Ring 1
   28725 Bremen
   Germany

   Phone: +49 421 200-3587
   Email: j.schoenwaelder@jacobs-university.de











van den Broek, et al.     Expires May 30, 2008                 [Page 17]

Internet-Draft       SNMP Trace Analysis Definitions       November 2007


Full Copyright Statement

   Copyright (C) The IETF Trust (2007).

   This document is subject to the rights, licenses and restrictions
   contained in BCP 78, and except as set forth therein, the authors
   retain all their rights.

   This document and the information contained herein are provided on an
   "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS
   OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST AND
   THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS
   OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF
   THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.


Intellectual Property

   The IETF takes no position regarding the validity or scope of any
   Intellectual Property Rights or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; nor does it represent that it has
   made any independent effort to identify any such rights.  Information
   on the procedures with respect to rights in RFC documents can be
   found in BCP 78 and BCP 79.

   Copies of IPR disclosures made to the IETF Secretariat and any
   assurances of licenses to be made available, or the result of an
   attempt made to obtain a general license or permission for the use of
   such proprietary rights by implementers or users of this
   specification can be obtained from the IETF on-line IPR repository at
   http://www.ietf.org/ipr.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights that may cover technology that may be required to implement
   this standard.  Please address the information to the IETF at
   ietf-ipr@ietf.org.


Acknowledgment

   Funding for the RFC Editor function is provided by the IETF
   Administrative Support Activity (IASA).





van den Broek, et al.     Expires May 30, 2008                 [Page 18]

